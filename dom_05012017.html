<html lang="en-US">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
	<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <!--<link rel="stylesheet" type="text/css" href="css/bootstrap.min.css">-->


    <link rel="stylesheet" type="text/css" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.5.0/css/font-awesome.min.css">
    <link href="https://ok1static.oktacdn.com/assets/js/sdk/okta-signin-widget/1.4.0/css/okta-sign-in.min.css" type="text/css" rel="stylesheet">
    <link rel="stylesheet" type="text/css" href="test.css">

    <script src="https://ok1static.oktacdn.com/assets/js/sdk/okta-signin-widget/1.4.0/js/okta-sign-in.min.js" type="text/javascript"></script>

    <link href="https://ok1static.oktacdn.com/assets/js/sdk/okta-signin-widget/1.4.0/css/okta-theme.css" type="text/css" rel="stylesheet">
    <link href="okta.css" type="text/css" rel="stylesheet">
    <!--<link href="css/LoginStyleSheet.css" type="text/css" rel="stylesheet">-->

    <script type="text/javascript" src="js/jquery.js?ver=2.7.2"></script>


    <title>Field Service Management Software for the Future | ClickSoftware</title>
<!--[if lt IE 9]>
      <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.2/html5shiv.min.js"></script>
  <![endif]-->

    <link rel="stylesheet" id="twentysixteen-style-css" href="css/style.css?ver=4.5.3" type="text/css" media="all">


    <link rel="stylesheet" id="wp-social-sharing-css" href="css/socialshare.css?ver=1.5" type="text/css" media="all">
    <script type="text/javascript" src="js/jquery.js?ver=1.12.4"></script>







</head>

<body style="">

    <section class="banner-part-start home-page-slider relative text-center">
        <div class="page-title">
            <div class="heading-title">
                <a id="logo" href="http://www.clicksoftware.com/"> <img src="click_logo.png" alt="ClickSoftware" title="ClickSoftware" style="width: 241px;"></a>
                <div class="main-part">

                    <div id="okta-login-container"></div>
                    <script type="text/javascript">
                        var baseUrl = 'https://clicksoftware.okta.com';
                        var oktaSignIn = new OktaSignIn({
                            baseUrl: baseUrl,

                            features: {
                                rememberMe: true,
                                selfServiceUnlock: false
                            },

                            helpLinks: {

                                forgotPassword: 'https://clicksoftware.secure.force.com/AccessRequestForm/ForgotMyPassword',

                                custom: [{
                                    text: 'New user registration',
                                    href: 'https://clicksoftware.secure.force.com/AccessRequestForm'
                                }, {
                                    text: 'ClickSoftware support hotline',
                                    href: 'https://www.clicksoftware.com/contact-us/'
                                }]
                            },
                            labels: {
                                'primaryauth.title': 'Welcome to ClickSoftware Partners Zone/Appstore/Download Center'
                            }

                        });
						
						oktaSignIn.session.exists(function (exists) {
						  if (exists) {
							// There is an active session
							debugger
						  } else {
							// No active session found
							debugger
						  }
						});

                       oktaSignIn.renderEl(
{ el: '#okta-login-container' },
function (res) {
if (res.status === 'SUCCESS') {

// url will be the url be something like -> https://clicksoftware.okta.com/login/login.htm?fromURI=%2Fapp%2Fclicksoftware_partnerzoneappstoredownloads_1%2Fexka0eagvdbLDT2Bh0x7%2Fsso%2Fsaml%3FRequestBinding%3DHTTPPost%26PartnerId%3Dhttps%3A%2F%2Fpartners.clicksoftware.com%26NameIdFormat%3DEmail%26RelayState%3D-1090635567 

//var url = String(window.location.href);

var url='https://clicksoftware.okta.com/login/login.htm?fromURI=%2Fapp%2Fclicksoftware_partnerzoneappstoredownloads_1%2Fexka0eagvdbLDT2Bh0x7%2Fsso%2Fsaml%3FRequestBinding%3DHTTPPost%26PartnerId%3Dhttps%3A%2F%2Fpartners.clicksoftware.com%26NameIdFormat%3DEmail%26RelayState%3D-1090635567 ';

var decodedUrl = decodeURIComponent(url);

// decodedUrl will be https://clicksoftware.okta.com/login/login.htm?fromURI=/app/clicksoftware_partnerzoneappstoredownloads_1/exka0eagvdbLDT2Bh0x7/sso/saml?RequestBinding=HTTPPost&PartnerId=https://partners.clicksoftware.com&NameIdFormat=Email&RelayState=-1090635567 


// At this point they will have to do the string operation on decodedUrl something like below. The number 10 being added to decodedUrl.indexOf(“PartnerId=”) is for the length of string partnerId

var startIndexOfPartnerIdurl = decodedUrl.indexOf('PartnerId=') +10 
var endIndexOfPartnerIdurl = decodedUrl.indexOf('&NameIdFormat=Email')

var partnerUrl = decodedUrl.slice(startIndexOfPartnerIdurl, endIndexOfPartnerIdurl)

// partnerUrl will turn out to be in this example url to -> https://partners.clicksoftware.com


// Similarly extract RelayState Url. 11 being added is length of string RelayState=

var startIndexOfRelayState = decodedUrl.indexOf('RelayState=') + 11 

var relayState = decodedUrl.slice(startIndexOfRelayState)

//relayState will turn out to be -1090635567 which they may need to decode before they can concatenate it with partnerUrl as below. 


//assuming relayState number is decoded. 

var urlToRedirect = partnerUrl + relayState


res.session.setCookieAndRedirect(urlToRedirect);

}
} 
)



                        function getParameterByName(name, url) {
                            if (!url) url = decodeURIComponent(window.location.href);
                            name = name.replace(/[\[\]]/g, "\\$&");
                            var regex = new RegExp("[?&]" + name + "(=([^&#]*)|&|#|$)"),
                                results = regex.exec(url);
                            if (!results) return null;
                            if (!results[2]) return '';
                            return decodeURIComponent(results[2].replace(/\+/g, " "));
                        }
                    </script>
                    <div id="footerLinks">
                        <div>Customers and Partners options:</div>
                        <ul>
                            <li>New Customer or Partner? Get your access <a href="https://clicksoftware.secure.force.com/AccessRequestForm">here</a></li>
							<li>Forgot your Password? Use our <a href="https://clicksoftware.secure.force.com/AccessRequestForm/ForgotMyPassword">password recovery page.</a></li>
                            <li>ClickSoftware <a href="http://www.clicksoftware.com/support-hotline">support hotline</a></li>
                            <li>For any other issues please email <a href="mailto:support@clicksoftware.com">ClickSoftware
                                        support.</a></li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>

    </section>









    <script type="text/javascript" src="js/jquery.min.js"></script>
    <script type="text/javascript" src="js/bootstrap.min.js"></script>
</body>

</html>